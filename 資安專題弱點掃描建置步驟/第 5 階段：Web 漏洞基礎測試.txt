ğŸ“Œ ç¬¬ 5 éšæ®µï¼šWeb æ¼æ´åŸºç¤æ¸¬è©¦ï¼ˆç¢ç‰‡åŒ–æ­¥é©Ÿï¼‰
5.1 æ•æ„Ÿæª”æ¡ˆèˆ‡è·¯å¾‘æª¢æŸ¥
ç›®çš„ï¼š å˜—è©¦å­˜å–å¸¸è¦‹æ•æ„Ÿæª”æ¡ˆæˆ–ç›®éŒ„ï¼Œç¢ºèªæ˜¯å¦å¯ç›´æ¥è¨ªå•ã€‚

æ¸¬è©¦è·¯å¾‘ï¼š

/robots.txt

/admin/

/phpinfo.php

/config/

/backup/

åˆ¤æ–·ï¼š

å¦‚æœå›æ‡‰ 200 OK ä¸”åŒ…å«å…§å®¹ â†’ é¡¯ç¤ºã€Œå¯èƒ½å­˜åœ¨æ•æ„Ÿæª”æ¡ˆ/ç›®éŒ„ã€ã€‚

å¦‚æœå›æ‡‰ 404 Not Found â†’ é¡¯ç¤ºã€Œæœªç™¼ç¾ã€ã€‚

5.2 éŒ¯èª¤è¨Šæ¯æ´©æ¼æ¸¬è©¦
ç›®çš„ï¼š å˜—è©¦è§¸ç™¼ä¼ºæœå™¨éŒ¯èª¤ï¼Œè§€å¯Ÿæ˜¯å¦å›å‚³æ•æ„Ÿè¨Šæ¯ã€‚

æ–¹æ³•ï¼š

ç™¼é€å¥‡æ€ªçš„ URLï¼Œä¾‹å¦‚ /test' æˆ– /id=1'.

æª¢æŸ¥å›æ‡‰ body æ˜¯å¦åŒ…å«ï¼š

SQL syntax error

Exception

Traceback

åˆ¤æ–·ï¼š

è‹¥å‡ºç¾ â†’ é¡¯ç¤ºã€Œå¯èƒ½å­˜åœ¨éŒ¯èª¤è¨Šæ¯æ´©æ¼ã€ã€‚

è‹¥ç„¡ â†’ é¡¯ç¤ºã€Œæœªç™¼ç¾ã€ã€‚


5.3 ç°¡å–® SQL Injection æ¸¬è©¦
ç›®çš„ï¼š å˜—è©¦åœ¨ URL åƒæ•¸ä¸­æ³¨å…¥ç°¡å–® SQL payloadã€‚

æ¸¬è©¦ç¯„ä¾‹ï¼š

?id=1' OR '1'='1

åˆ¤æ–·ï¼š

å¦‚æœå›æ‡‰ç•°å¸¸ï¼ˆä¾‹å¦‚é¡¯ç¤ºæ‰€æœ‰è³‡æ–™æˆ–éŒ¯èª¤è¨Šæ¯ï¼‰ â†’ é¡¯ç¤ºã€Œå¯èƒ½å­˜åœ¨ SQL Injectionã€ã€‚

å¦‚æœå›æ‡‰æ­£å¸¸ â†’ é¡¯ç¤ºã€Œæœªç™¼ç¾ã€ã€‚


5.4 ç°¡å–® XSS æ¸¬è©¦
ç›®çš„ï¼š å˜—è©¦åœ¨ URL åƒæ•¸ä¸­æ³¨å…¥ç°¡å–® JavaScriptã€‚

æ¸¬è©¦ç¯„ä¾‹ï¼š

?q=<script>alert(1)</script>

åˆ¤æ–·ï¼š

å¦‚æœå›æ‡‰ body ä¸­åå°„å‡º <script>alert(1)</script> â†’ é¡¯ç¤ºã€Œå¯èƒ½å­˜åœ¨ XSSã€ã€‚

å¦‚æœæ²’æœ‰ â†’ é¡¯ç¤ºã€Œæœªç™¼ç¾ã€ã€‚


5.5 Cookie å®‰å…¨æ€§æª¢æŸ¥
ç›®çš„ï¼š æª¢æŸ¥ä¼ºæœå™¨å›æ‡‰çš„ Cookie æ˜¯å¦æœ‰å®‰å…¨æ¨™è¨˜ã€‚

æª¢æŸ¥é …ç›®ï¼š

HttpOnly â†’ é˜²æ­¢ JavaScript å­˜å– Cookieã€‚

Secure â†’ åƒ…åœ¨ HTTPS å‚³è¼¸ã€‚

åˆ¤æ–·ï¼š

å¦‚æœç¼ºå¤± â†’ é¡¯ç¤ºã€ŒCookie å®‰å…¨æ€§ä¸è¶³ã€ã€‚

å¦‚æœå­˜åœ¨ â†’ é¡¯ç¤ºã€ŒCookie å®‰å…¨æ€§è‰¯å¥½ã€ã€‚


5.6 çµ±æ•´æ¸¬è©¦çµæœ
ç›®çš„ï¼š å°‡ä»¥ä¸Šæ¸¬è©¦çµæœæ•´åˆæˆä¸€ä»½çµæ§‹åŒ–è¼¸å‡ºï¼ˆå­—å…¸æˆ–è¡¨æ ¼ï¼‰ã€‚

ç¯„ä¾‹è¼¸å‡ºï¼š
data/web_vuln_results.json
{
  "sensitive_files": ["robots.txt: Found", "admin/: Not Found"],
  "error_leak": "Not Found",
  "sql_injection": "Not Found",
  "xss": "Not Found",
  "cookie_security": "Missing HttpOnly, Missing Secure"
}


ğŸ¯ ç¸½çµ
ç¬¬äº”éšæ®µçš„ Web æ¼æ´åŸºç¤æ¸¬è©¦åŒ…å«ï¼š

æ•æ„Ÿæª”æ¡ˆèˆ‡è·¯å¾‘æª¢æŸ¥

éŒ¯èª¤è¨Šæ¯æ´©æ¼æ¸¬è©¦

ç°¡å–® SQL Injection æ¸¬è©¦

ç°¡å–® XSS æ¸¬è©¦

Cookie å®‰å…¨æ€§æª¢æŸ¥

çµ±æ•´æ¸¬è©¦çµæœ





modules/web_vuln_test.pyç¯„ä¾‹

import requests

# -------------------------
# æ•æ„Ÿæª”æ¡ˆèˆ‡è·¯å¾‘æª¢æŸ¥
# -------------------------
def check_sensitive_files(target_ip, port=80, use_https=False):
    scheme = "https" if use_https else "http"
    base_url = f"{scheme}://{target_ip}:{port}/"
    test_paths = ["robots.txt", "admin/", "phpinfo.php", "config/", "backup/"]

    results = []
    for path in test_paths:
        url = base_url + path
        try:
            resp = requests.get(url, timeout=3)
            if resp.status_code == 200:
                results.append(f"{path}: Found")
            else:
                results.append(f"{path}: Not Found")
        except Exception:
            results.append(f"{path}: Error")
    return results

# -------------------------
# éŒ¯èª¤è¨Šæ¯æ´©æ¼æ¸¬è©¦
# -------------------------
def check_error_leak(target_ip, port=80, use_https=False):
    scheme = "https" if use_https else "http"
    url = f"{scheme}://{target_ip}:{port}/test'"
    try:
        resp = requests.get(url, timeout=3)
        body = resp.text
        if any(keyword in body for keyword in ["SQL syntax", "Exception", "Traceback"]):
            return "Found"
        return "Not Found"
    except Exception:
        return "Error"

# -------------------------
# ç°¡å–® SQL Injection æ¸¬è©¦
# -------------------------
def check_sql_injection(target_ip, port=80, use_https=False):
    scheme = "https" if use_https else "http"
    url = f"{scheme}://{target_ip}:{port}/?id=1' OR '1'='1"
    try:
        resp = requests.get(url, timeout=3)
        if "error" in resp.text.lower() or "syntax" in resp.text.lower():
            return "Possible SQL Injection"
        return "Not Found"
    except Exception:
        return "Error"

# -------------------------
# ç°¡å–® XSS æ¸¬è©¦
# -------------------------
def check_xss(target_ip, port=80, use_https=False):
    scheme = "https" if use_https else "http"
    payload = "<script>alert(1)</script>"
    url = f"{scheme}://{target_ip}:{port}/?q={payload}"
    try:
        resp = requests.get(url, timeout=3)
        if payload in resp.text:
            return "Possible XSS"
        return "Not Found"
    except Exception:
        return "Error"

# -------------------------
# Cookie å®‰å…¨æ€§æª¢æŸ¥
# -------------------------
def check_cookie_security(target_ip, port=80, use_https=False):
    scheme = "https" if use_https else "http"
    url = f"{scheme}://{target_ip}:{port}/"
    try:
        resp = requests.get(url, timeout=3)
        cookies = resp.cookies
        results = []
        for c in cookies:
            if not c.has_nonstandard_attr("HttpOnly"):
                results.append("Missing HttpOnly")
            if use_https and not c.secure:
                results.append("Missing Secure")
        return results if results else ["Cookie Security OK"]
    except Exception:
        return ["Error"]

# -------------------------
# ä¸»æ¸¬è©¦æµç¨‹
# -------------------------
def run_tests(target_ip, port=80, use_https=False):
    results = {
        "sensitive_files": check_sensitive_files(target_ip, port, use_https),
        "error_leak": check_error_leak(target_ip, port, use_https),
        "sql_injection": check_sql_injection(target_ip, port, use_https),
        "xss": check_xss(target_ip, port, use_https),
        "cookie_security": check_cookie_security(target_ip, port, use_https)
    }
    return results


scanner.pyç¯„ä¾‹

import json
from modules import port_scan, banner, version_compare, http_check, web_vuln_test

if __name__ == "__main__":
    target_ip = "127.0.0.1"
    ports = [22, 80, 443, 3306, 6379]

    open_ports = port_scan.port_scan(target_ip, ports)
    print("[+] Open Ports:", open_ports)

    banners = banner.grab_banners(target_ip, open_ports)
    print("[+] Banners:", banners)

    baseline = version_compare.load_baseline("data/known_versions.json")
    verdicts = version_compare.evaluate_banners(banners, baseline)
    for v in verdicts:
        print(f"- {v.get('port')}/tcp {v.get('service')} {v.get('version')} â†’ {v.get('status')}")

    # HTTP åŸºæœ¬æª¢æŸ¥ + Webæ¼æ´æ¸¬è©¦
    if 80 in open_ports:
        print("[+] HTTP Basic Check:")
        result = http_check.http_basic_check(target_ip, 80, use_https=False)
        print(result)

        print("[+] Web Vulnerability Tests:")
        vuln_results = web_vuln_test.run_tests(target_ip, 80)
        print(vuln_results)

        # è¼¸å‡ºåˆ° JSON æª”æ¡ˆ
        with open("data/web_vuln_results.json", "w", encoding="utf-8") as f:
            json.dump(vuln_results, f, indent=4, ensure_ascii=False)

    if 443 in open_ports:
        print("[+] HTTPS Basic Check:")
        result = http_check.http_basic_check(target_ip, 443, use_https=True)
        print(result)

        print("[+] Web Vulnerability Tests (HTTPS):")
        vuln_results = web_vuln_test.run_tests(target_ip, 443, use_https=True)
        print(vuln_results)

        with open("data/web_vuln_results.json", "w", encoding="utf-8") as f:
            json.dump(vuln_results, f, indent=4, ensure_ascii=False)



æ¸¬è©¦æ–¹å¼:

åœ¨çµ‚ç«¯æ©Ÿè¼¸å…¥pythoné€²å…¥äº’å‹•æ¨¡å¼
æ¥è‘—è¼¸å…¥from modules import web_vuln_testå¼•ç”¨æª”æ¡ˆå…§å®¹åˆ°äº’å‹•æ¨¡å¼ç’°å¢ƒå…§
å®šç¾©resultresult = web_vuln_test.run_tests("127.0.0.1", 80, use_https=False)
è¼¸å‡ºprint(result)
å…§å®¹ç¯„ä¾‹
{'sensitive_files': ['robots.txt: Not Found', 'admin/: Not Found', 'phpinfo.php: Not Found', 'config/: Not Found', 'backup/: Not Found'], 'error_leak': 'Not Found', 'sql_injection': 'Not Found', 'xss': 'Not Found', 'cookie_security': ['Cookie Security OK']}